<!DOCTYPE html>
<html>
    <head>
        <title>My Songs</title>
        <script type="text/javascript" src="https://w.soundcloud.com/player/api.js"></script>
    </head>
  <body>
    <ul>
      <li>
        <span>Alice Phoebe Lou - Fiery Heart, Fiery Mind (official video)</span>
        <img class="ytButton" src="http://findicons.com/files/icons/129/soft_scraps/256/button_play_01.png" alt="https://www.youtube.com/v/KuAXv5qaSbQ" style="width: 20px; height: 20px;"/>
        <br/><a href="https://www.youtube.com/watch?v=KuAXv5qaSbQ" target="_blank" >Source</a>
      </li>
      <li>
        <span>Lukas Graham - 7 Years</span>
        <img class="scButton" src="http://findicons.com/files/icons/129/soft_scraps/256/button_play_01.png" alt="https://soundcloud.com/lukasgraham/7-years" style="width: 20px; height: 20px;"/>
        <br/><a href="https://soundcloud.com/lukasgraham/7-years" target="_blank" >Source</a>
      </li>
    </ul>
    <!-- 1. The <iframe> (and video yt_player) will replace this <div> tag. -->
    <div id="yt_player" class="player" style="display: none;"></div>
    <div id="sc_player" class="player" style="display: none;">
        <iframe id="sc-widget" scrolling="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/231715226" frameborder="no"></iframe>
    </div>

    <script type="text/javascript">
    
      var Player = function(){
        this.ytPlayerId;
        this.ytPlayer;
        this.scWidgetId;
        this.scPlayerId;
        this.scPlayer;
      };
      
      Player.prototype.playVideo = function(videoId, videoSource){
        
        console.log("playing video " + videoId)
        
        if(videoSource == "YT"){
          this.togglePlayer(this.ytPlayerId);
          this._playVideoYt(videoId);
        }
        else if (videoSource == "SC"){
          this.togglePlayer(this.scPlayerId);
          this._playVideoSc(videoId);
        }
      };
      
      Player.prototype.togglePlayer = function(playerId){
        for (var i = 0, el; el = document.getElementsByClassName("player")[i]; i++){
          el.style.display = "none";
        }
        document.getElementById(playerId).style.display = "block";
      }
      
      Player.prototype.initYoutube = function(playerId){
        this.ytPlayerId = playerId;
        this.ytPlayer = new YT.Player(playerId, {
          height: '390',
          width: '640',
          videoId: 'M7lc1UVf-VE',
          events: {
            'onReady': this._onYtPlayerReady,
            'onStateChange': this._onYtPlayerStateChange
          }
        });
      };
      
      Player.prototype.initSoundcloud = function(playerId, iframeId){
        
        console.log("Init Soundcloud");
        
        this.scPlayerId = playerId;
        this.scWidgetId = iframeId;
        this.scPlayer   = SC.Widget(this.scWidgetId);
        
        
        //this.scPlayer.bind(SC.Widget.Events.READY, function() {
          //this.scPlayer.bind(SC.Widget.Events.PLAY, function() {
            // get information about currently playing sound
            //this.scPlayer.getCurrentSound(function(currentSound) {
              //console.log('sound ' + currentSound.title + 'began to play');
              //document.getElementById("songname").innerHTML = currentSound.username + " - " + currentSound.title;
            //});
          //});
          
          // set new volume level
          // widget.setVolume(50);
          // get the value of the current position
        //});
        
        var songElements = document.querySelectorAll('.scButton');
        
        console.log("found " + songElements.length + " song elements");
        for( var i in songElements) {
          var songElement = songElements[i];
          var scUrl = songElement.alt;
          if(scUrl != undefined){
            console.log("Setting a funtion for img " + scUrl);
            songElement.onclick = function(e){
              var scUrl = e.target.alt;
              playVideo(scUrl, "SC");
            }
          }
        }
      }
      
      Player.prototype._playVideoYt = function(videoUrl){
        this.ytPlayer.loadVideoByUrl({'mediaContentUrl': videoUrl});
        this.ytPlayer.playVideo();
      }
      
      Player.prototype._playVideoSc = function(videoUrl){
        this.scPlayer.load(videoUrl, {
          auto_play: true
        });
      };
      
      Player.prototype._onYtPlayerReady = function(){
        var songElements = document.querySelectorAll('.ytButton');
        console.log("found " + songElements.length + " song elements");
        for(var i in songElements) {
          var songElement = songElements[i];
          var songUrl = songElement.alt;
          if(songUrl != undefined){
            console.log("Setting click for play button with url " + songUrl);
            songElement.onclick = function(e){
              var videoUrl = e.target.alt;
              console.log("Loading video "+ videoUrl);
              playVideo(videoUrl, "YT")
            }
          }
        };
      };
      
      Player.prototype._onYtPlayerStateChange = function(){
        
      };
      
      var player = new Player();
      player.initSoundcloud("sc_player", "sc-widget");
      
      function playVideo(videoUrl, videoSource){
        player.playVideo(videoUrl, videoSource)
      }
      
      // 2. This code loads the IFrame Player API code asynchronously.
      var tag = document.createElement('script');
  
      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
    
      // 3. This function creates an <iframe> (and YouTube player)
      //    after the API code downloads.
      function onYouTubeIframeAPIReady() {
        console.log("Init Youtube");
        player.initYoutube("yt_player");
        
      }
      
    </script>
  </body>
</html>